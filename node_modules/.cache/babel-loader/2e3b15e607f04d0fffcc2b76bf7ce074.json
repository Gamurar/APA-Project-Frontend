{"ast":null,"code":"import _slicedToArray from\"/home/gamurar/mastertoken/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/home/gamurar/mastertoken/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import'./Login.css';import React,{useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Link}from'react-router-dom';import AuthService from'../../services/auth.service';import{loginSuccess,loginFail,setUser}from'../../app/authSlice';import{history}from'../../helpers/history';import BaseButton from'../../components/Views/Button/Button';import styled from'styled-components';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Button=styled(BaseButton)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  font-size: 14px;\\n  &:hover,\\n  &:focus {\\n    border: 2px solid rgba(112, 76, 182, 0.4);\\n  }\\n\\n  &:active {\\n    background-color: rgba(112, 76, 182, 0.2);\\n  }\\n\"])));var Login=function Login(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useSelector=useSelector(function(state){return state.auth;}),message=_useSelector.message;var dispatch=useDispatch();var onChangeEmail=function onChangeEmail(e){var email=e.target.value;setEmail(email);};var onChangePassword=function onChangePassword(e){var password=e.target.value;setPassword(password);};var handleLogin=function handleLogin(e){e.preventDefault();setLoading(true);AuthService.login(email,password).then(function(data){dispatch(loginSuccess(data.accessToken));return AuthService.me();}).then(function(user){dispatch(setUser(user));history.push('/profile');window.location.reload();}).catch(function(error){var _error$response,_error$response$data;dispatch(loginFail((error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||(error===null||error===void 0?void 0:error.message)||'Something went wrong'));setLoading(false);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login__header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header__title\",children:\"Sign in\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"header__create\",children:[\"or \",/*#__PURE__*/_jsx(Link,{to:\"/register\",className:\"header__link\",children:\"create an account\"})]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,className:\"login__form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form__field\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"field__input\",name:\"email\",value:email,placeholder:\"Email\",onChange:onChangeEmail})}),/*#__PURE__*/_jsx(\"div\",{className:\"form__field\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"field__input\",name:\"password\",value:password,placeholder:\"Password\",onChange:onChangePassword})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form__actions\",children:[/*#__PURE__*/_jsx(Link,{to:\"/forgot-password\",className:\"actions__forgot-password\",children:\"Forgot your password?\"}),/*#__PURE__*/_jsx(Button,{disabled:loading,children:loading?/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm\",children:\"Loading...\"}):/*#__PURE__*/_jsx(\"span\",{children:\"Sign in\"})})]}),message&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red'},children:message})]})]});};export default Login;","map":{"version":3,"sources":["/home/gamurar/mastertoken/frontend/src/pages/Login/Login.tsx"],"names":["React","useState","useDispatch","useSelector","Link","AuthService","loginSuccess","loginFail","setUser","history","BaseButton","styled","Button","Login","props","email","setEmail","password","setPassword","loading","setLoading","state","auth","message","dispatch","onChangeEmail","e","target","value","onChangePassword","handleLogin","preventDefault","login","then","data","accessToken","me","user","push","window","location","reload","catch","error","response","color"],"mappings":"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","sourcesContent":["import './Login.css';\nimport React, { useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { RootState } from '../../app/store';\nimport AuthService from '../../services/auth.service';\nimport { loginSuccess, loginFail, setUser } from '../../app/authSlice';\nimport { history } from '../../helpers/history';\nimport BaseButton from '../../components/Views/Button/Button';\nimport styled from 'styled-components';\n\nconst Button = styled(BaseButton)`\n  font-size: 14px;\n  &:hover,\n  &:focus {\n    border: 2px solid rgba(112, 76, 182, 0.4);\n  }\n\n  &:active {\n    background-color: rgba(112, 76, 182, 0.2);\n  }\n`;\n\nconst Login = (props: any) => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const { message } = useSelector((state: RootState) => state.auth);\n\n  const dispatch = useDispatch();\n\n  const onChangeEmail = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const email = e.target.value;\n    setEmail(email);\n  };\n\n  const onChangePassword = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const password = e.target.value;\n    setPassword(password);\n  };\n\n  const handleLogin = (e: React.SyntheticEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    AuthService.login(email, password)\n      .then((data) => {\n        dispatch(loginSuccess(data.accessToken));\n        return AuthService.me();\n      })\n      .then((user) => {\n        dispatch(setUser(user));\n        history.push('/profile');\n        window.location.reload();\n      })\n      .catch((error) => {\n        dispatch(loginFail(error?.response?.data?.message || error?.message || 'Something went wrong'));\n        setLoading(false);\n      });\n  };\n\n  return (\n    <div className='login'>\n        <div className='login__header'>\n          <div className=\"header__title\">Sign in</div>\n          <div className=\"header__create\">or <Link to=\"/register\" className='header__link'>create an account</Link></div>\n        </div>\n        <form onSubmit={handleLogin} className=\"login__form\">\n          <div className=\"form__field\">\n            <input\n              type=\"text\"\n              className=\"field__input\"\n              name=\"email\"\n              value={email}\n              placeholder=\"Email\"\n              onChange={onChangeEmail}\n            />\n          </div>\n\n          <div className=\"form__field\">\n            <input\n              type=\"password\"\n              className=\"field__input\"\n              name=\"password\"\n              value={password}\n              placeholder=\"Password\"\n              onChange={onChangePassword}\n            />\n          </div>\n\n          <div className='form__actions'>\n            <Link to='/forgot-password' className='actions__forgot-password'>Forgot your password?</Link>\n            <Button disabled={loading}>\n              {loading ? <span className=\"spinner-border spinner-border-sm\">Loading...</span> : <span>Sign in</span>}\n            </Button>\n          </div>\n\n          {message && <div style={{ color: 'red' }}>{message}</div>}\n        </form>\n      </div>\n  );\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}